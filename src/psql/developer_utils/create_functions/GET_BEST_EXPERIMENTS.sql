CREATE OR REPLACE FUNCTION GET_BEST_EXPERIMENTS(PARAM_EXPERIMENT_GROUP_ID BIGINT, PARAM_NUM_TO_RETURN INT ) RETURNS TABLE (EXPERIMENT_ID BIGINT, SCORE REAL)
AS
$$
	SELECT
		E.ID AS EXPERIMENT_ID,
		E.MEAN_SCORE
	FROM
		EXPERIMENT E
	WHERE
		E.EXPERIMENT_GROUP_ID = PARAM_EXPERIMENT_GROUP_ID
	AND
		TOTAL_TRIALS > 0
	ORDER BY
		E.MEAN_SCORE DESC
	LIMIT
		PARAM_NUM_TO_RETURN;
$$
LANGUAGE SQL;

